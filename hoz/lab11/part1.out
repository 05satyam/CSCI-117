[local ["SumListS","SumList","Out1","Out2"] [SumList = proc {$ L EXU1} [case L of nil() then [EXU1 = 0] else [case L of '|'(1:H 2:T) then [local ["EXU2","EXU3"] [EXU2 = H,local ["EXU5"] [EXU5 = T,"SumList" "EXU5" "EXU3"],"IntPlus" "EXU2" "EXU3" "EXU1"]] else [skip]]],SumListS = proc {$ L EXU1} [local ["SumListN"] [local ["SListS"] [local ["NCU2"] [NCU2 = 0,{NewCell NCU2 SListS}],SumListN = proc {$ L EXU2} [case L of nil() then [{Exchange SListS EXU2 EXU2}] else [case L of '|'(1:H 2:T) then [local ["SCU3","GarbU3"] [local ["EXU4","EXU5"] [EXU4 = H,{Exchange SListS EXU5 EXU5},"IntPlus" "EXU4" "EXU5" "SCU3"],{Exchange SListS GarbU3 SCU3}],local ["EXU3"] [EXU3 = T,"SumListN" "EXU3" "EXU2"]] else [skip]]],local ["EXU2"] [EXU2 = L,"SumListN" "EXU2" "EXU1"]]]],local ["EXU1"] [local ["EXU2","EXU3","EXU4","EXU5"] [EXU2 = 1,EXU3 = 2,EXU4 = 3,EXU5 = 4,local ["EXU6","EXU7"] [EXU6 = EXU2,local ["EXU8","EXU9"] [EXU8 = EXU3,local ["EXU10","EXU11"] [EXU10 = EXU4,local ["EXU12","EXU13"] [EXU12 = EXU5,EXU13 = nil(),EXU11 = '|'(1:EXU12 2:EXU13)],EXU9 = '|'(1:EXU10 2:EXU11)],EXU7 = '|'(1:EXU8 2:EXU9)],EXU1 = '|'(1:EXU6 2:EXU7)]],"SumList" "EXU1" "Out1"],local ["EXU1"] [local ["EXU2","EXU3","EXU4","EXU5"] [EXU2 = 1,EXU3 = 2,EXU4 = 3,EXU5 = 4,local ["EXU6","EXU7"] [EXU6 = EXU2,local ["EXU8","EXU9"] [EXU8 = EXU3,local ["EXU10","EXU11"] [EXU10 = EXU4,local ["EXU12","EXU13"] [EXU12 = EXU5,EXU13 = nil(),EXU11 = '|'(1:EXU12 2:EXU13)],EXU9 = '|'(1:EXU10 2:EXU11)],EXU7 = '|'(1:EXU8 2:EXU9)],EXU1 = '|'(1:EXU6 2:EXU7)]],"SumListS" "EXU1" "Out2"],skip/BOut1,skip/BOut2,skip/f],local ["FoldLS","FoldL","Out1","Out2","Z"] [FoldL = proc {$ F Z L EXU1} [case L of nil() then [EXU1 = Z] else [case L of '|'(1:H 2:T) then [local ["EXU2","EXU3","EXU4"] [EXU2 = F,local ["EXU5","EXU6"] [EXU5 = Z,EXU6 = H,"F" "EXU5" "EXU6" "EXU3"],EXU4 = T,"FoldL" "EXU2" "EXU3" "EXU4" "EXU1"]] else [skip]]],FoldLS = proc {$ F Z L EXU1} [local ["FoldLN"] [local ["FL"] [local ["NCU2"] [NCU2 = 0,{NewCell NCU2 FL}],FoldLN = proc {$ F Z L} [case L of nil() then [local ["SCU2","GarbU2"] [{Exchange FL SCU2 SCU2},{Exchange FL GarbU2 SCU2}]] else [case L of '|'(1:H 2:T) then [local ["SCU2","GarbU2"] [SCU2 = 0,{Exchange FL GarbU2 SCU2}],local ["SCU2","GarbU2"] [local ["EXU3","EXU4"] [EXU3 = Z,EXU4 = H,"F" "EXU3" "EXU4" "SCU2"],{Exchange FL GarbU2 SCU2}],local ["EXU2","EXU3","EXU4"] [EXU2 = F,{Exchange FL EXU3 EXU3},EXU4 = T,"FoldLN" "EXU2" "EXU3" "EXU4"]] else [skip]]],local ["EXU2","EXU3","EXU4"] [EXU2 = F,EXU3 = Z,EXU4 = L,"FoldLN" "EXU2" "EXU3" "EXU4"],{Exchange FL EXU1 EXU1}]]],local ["EXU1","EXU2","EXU3"] [EXU1 = proc {$ X Y EXU4} [local ["EXU5","EXU6"] [EXU5 = X,EXU6 = Y,"IntPlus" "EXU5" "EXU6" "EXU4"]],EXU2 = 3,local ["EXU4","EXU5","EXU6","EXU7"] [EXU4 = 1,EXU5 = 2,EXU6 = 3,EXU7 = 4,local ["EXU8","EXU9"] [EXU8 = EXU4,local ["EXU10","EXU11"] [EXU10 = EXU5,local ["EXU12","EXU13"] [EXU12 = EXU6,local ["EXU14","EXU15"] [EXU14 = EXU7,EXU15 = nil(),EXU13 = '|'(1:EXU14 2:EXU15)],EXU11 = '|'(1:EXU12 2:EXU13)],EXU9 = '|'(1:EXU10 2:EXU11)],EXU3 = '|'(1:EXU8 2:EXU9)]],"FoldL" "EXU1" "EXU2" "EXU3" "Out1"],local ["EXU1","EXU2","EXU3"] [EXU1 = proc {$ X Y EXU4} [local ["EXU5","EXU6"] [EXU5 = X,EXU6 = Y,"IntPlus" "EXU5" "EXU6" "EXU4"]],EXU2 = 3,local ["EXU4","EXU5","EXU6","EXU7"] [EXU4 = 1,EXU5 = 2,EXU6 = 3,EXU7 = 4,local ["EXU8","EXU9"] [EXU8 = EXU4,local ["EXU10","EXU11"] [EXU10 = EXU5,local ["EXU12","EXU13"] [EXU12 = EXU6,local ["EXU14","EXU15"] [EXU14 = EXU7,EXU15 = nil(),EXU13 = '|'(1:EXU14 2:EXU15)],EXU11 = '|'(1:EXU12 2:EXU13)],EXU9 = '|'(1:EXU10 2:EXU11)],EXU3 = '|'(1:EXU8 2:EXU9)]],"FoldLS" "EXU1" "EXU2" "EXU3" "Out2"],skip/BOut1,skip/BOut2,skip/f],local ["Generate","Num","GenF","Out1","Out2","Out3"] [Generate = proc {$ EXU1} [local ["NCU2"] [NCU2 = -1,{NewCell NCU2 Num}],EXU1 = proc {$ EXU2} [local ["SCU3","GarbU3"] [local ["EXU4","EXU5"] [{Exchange Num EXU4 EXU4},EXU5 = 1,"IntPlus" "EXU4" "EXU5" "SCU3"],{Exchange Num GarbU3 SCU3}],{Exchange Num EXU2 EXU2}]],"Generate" "GenF","GenF" "Out1","GenF" "Out2","GenF" "Out3",skip/BOut1,skip/BOut2,skip/BOut3],local ["NewQueue","S","Pu","Po","IsE","Av","A1","A2","B1","B2","V1","V2","V3","Out","Append","Out1"] [Append = proc {$ Ls Ms EXU1} [case Ls of nil() then [local ["EXU2","EXU3"] [EXU2 = Ms,EXU3 = nil(),EXU1 = '|'(1:EXU2 2:EXU3)]] else [case Ls of '|'(1:X 2:Lr) then [local ["Y"] [local ["EXU2","EXU3"] [EXU2 = Lr,EXU3 = Ms,"Append" "EXU2" "EXU3" "Y"],local ["EXU2","EXU3"] [EXU2 = X,EXU3 = Y,EXU1 = '|'(1:EXU2 2:EXU3)]]] else [skip]]],NewQueue = proc {$ L EXU1} [local ["Push","Pop","IsEmpty","SlotsAvailable"] [local ["C"] [local ["NCU2"] [NCU2 = nil(),{NewCell NCU2 C}],local ["S"] [local ["NCU2"] [NCU2 = 0,{NewCell NCU2 S}],Push = proc {$ X} [local ["EXU2"] [local ["EXU3","EXU4"] [{Exchange S EXU3 EXU3},EXU4 = L,"Eq" "EXU3" "EXU4" "EXU2"],if EXU2 then [local ["B"] [{Exchange C B B},case B of '|'(1:Y 2:S1) then [local ["SCU2","GarbU2"] [SCU2 = S1,{Exchange C GarbU2 SCU2}]] else [skip],local ["SCU2","GarbU2"] [local ["EXU3","EXU4"] [{Exchange C EXU3 EXU3},EXU4 = X,"Append" "EXU3" "EXU4" "SCU2"],{Exchange C GarbU2 SCU2}],local ["SCU2","GarbU2"] [local ["EXU3","EXU4"] [{Exchange S EXU3 EXU3},EXU4 = 1,"IntPlus" "EXU3" "EXU4" "SCU2"],{Exchange S GarbU2 SCU2}]]] else [local ["SCU2","GarbU2"] [local ["EXU3","EXU4"] [{Exchange C EXU3 EXU3},EXU4 = X,"Append" "EXU3" "EXU4" "SCU2"],{Exchange C GarbU2 SCU2}],local ["SCU2","GarbU2"] [local ["EXU3","EXU4"] [{Exchange S EXU3 EXU3},EXU4 = 1,"IntPlus" "EXU3" "EXU4" "SCU2"],{Exchange S GarbU2 SCU2}]]]],Pop = proc {$ EXU2} [local ["B"] [{Exchange C B B},case B of '|'(1:X 2:S1) then [local ["SCU3","GarbU3"] [SCU3 = S1,{Exchange C GarbU3 SCU3}],EXU2 = X] else [skip]]],IsEmpty = proc {$ EXU2} [local ["EXU3","EXU4"] [{Exchange C EXU3 EXU3},EXU4 = nil(),"Eq" "EXU3" "EXU4" "EXU2"]],SlotsAvailable = proc {$ EXU2} [local ["B"] [local ["EXU3","EXU4"] [EXU3 = L,{Exchange S EXU4 EXU4},"IntMinus" "EXU3" "EXU4" "B"],EXU2 = B]],local ["EXU2","EXU3","EXU4","EXU5"] [EXU2 = Push,EXU3 = Pop,EXU4 = IsEmpty,EXU5 = SlotsAvailable,EXU1 = ops(push:EXU2 pop:EXU3 isEmpty:EXU4 avail:EXU5)]]]]],local ["EXU1"] [EXU1 = 2,"NewQueue" "EXU1" "S"],local ["EXU1","EXU2","EXU3","EXU4"] [EXU1 = Pu,EXU2 = Po,EXU3 = IsE,EXU4 = Av,S = ops(push:EXU1 pop:EXU2 isEmpty:EXU3 avail:EXU4)],"IsE" "B1","Av" "A1",local ["EXU1"] [EXU1 = 1,"Pu" "EXU1"],local ["EXU1"] [EXU1 = 2,"Pu" "EXU1"],"Av" "A2",local ["EXU1"] [EXU1 = 3,"Pu" "EXU1"],"IsE" "B2","Po" "V1","Po" "V2","Po" "V3",local ["EXU1","EXU2","EXU3","EXU4","EXU5","EXU6","EXU7"] [EXU1 = V1,EXU2 = V2,EXU3 = V3,EXU4 = B1,EXU5 = B2,EXU6 = A1,EXU7 = A2,local ["EXU8","EXU9"] [EXU8 = EXU1,local ["EXU10","EXU11"] [EXU10 = EXU2,local ["EXU12","EXU13"] [EXU12 = EXU3,local ["EXU14","EXU15"] [EXU14 = EXU4,local ["EXU16","EXU17"] [EXU16 = EXU5,local ["EXU18","EXU19"] [EXU18 = EXU6,local ["EXU20","EXU21"] [EXU20 = EXU7,EXU21 = nil(),EXU19 = '|'(1:EXU20 2:EXU21)],EXU17 = '|'(1:EXU18 2:EXU19)],EXU15 = '|'(1:EXU16 2:EXU17)],EXU13 = '|'(1:EXU14 2:EXU15)],EXU11 = '|'(1:EXU12 2:EXU13)],EXU9 = '|'(1:EXU10 2:EXU11)],Out = '|'(1:EXU8 2:EXU9)]],skip/BOut]]